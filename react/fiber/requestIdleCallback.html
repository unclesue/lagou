<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <div id="root" style="background-color: gray; padding: 10px">
      <button id="compute">计算</button>
      <button id="change">换肤</button>
    </div>
    <script>
      const root = document.getElementById("root");
      const compute = document.getElementById("compute");
      const change = document.getElementById("change");
      let index = 999999;
      function calc(deadline) {
        while (index > 0 && deadline.timeRemaining() > 1) {
          let random = Math.random() < 0.5 ? Math.random() : Math.random();
          console.log(random);
          index--;
        }
        requestIdleCallback(calc)
      }
      compute.addEventListener("click", () => {
        requestIdleCallback(calc)
      });
      change.addEventListener("click", () => {
        root.style.backgroundColor = "green";
      });
    </script>
  </body>
</html>
